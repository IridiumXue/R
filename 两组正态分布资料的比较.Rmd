---
title: "两组正态分布资料的比较"
author: "IridiumXue"
date: "2025-06-06"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

18名糖尿病患者以及20名正常人的血清胆固醇含量，欲比较两组人群的血清总胆固醇含量是否有统计学差异。

```{r dataset} 

library(car)

# 正常人群血清总胆固醇含量 (20名)
cholesterol_normal <- c(2.93, 3.5, 3.21, 4, 4.01, 5.03, 3.9, 2.82, 4.16, 3.48, 3.63, 3.3, 3.53, 3.72, 4.03, 4.65, 4.29, 4.22, 3.01, 3.56)

# 糖尿病人群血清总胆固醇含量 (18名)
cholesterol_diabetic <- c(4.25, 4.36, 4, 3.99, 5.36, 4.78, 4.27, 5.54, 4.47, 5.21, 5.03, 4.67, 4.89, 4.36, 4.73, 4.28, 5.36, 4.3)

# 换为长格式
data_long <- data.frame(
  cholesterol = c(cholesterol_normal, cholesterol_diabetic),
  group = factor(c(rep("Normal", length(cholesterol_normal)), rep("Diabetic", length(cholesterol_diabetic))))
)

```

```{r 正态检验}

# 对正常人群组进行Shapiro-Wilk正态性检验
shapiro_normal <- shapiro.test(cholesterol_normal)
cat("正常人群组 Shapiro-Wilk正态性检验结果:\n")
print(shapiro_normal)

# 对糖尿病人群组进行Shapiro-Wilk正态性检验
shapiro_diabetic <- shapiro.test(cholesterol_diabetic)
cat("\n糖尿病人群组 Shapiro-Wilk正态性检验结果:\n")
print(shapiro_diabetic)

```

```{r 方差齐性检验}

# Levene's test 方差齐性检验

# formula: response variable ~ grouping factor
levene_test_result <- leveneTest(cholesterol ~ group, data = data_long)
cat("Levene's 方差齐性检验结果:\n")
print(levene_test_result)

```

```{r t test}

# 根据方差齐性检验结果，确定t检验的var.equal参数
variances_equal <- levene_test_result$`Pr(>F)`[1] > 0.05

# 进行t检验
if (variances_equal) {
  cat("根据Levene's检验结果 (p > 0.05)，两组方差齐性，使用普通独立样本t检验。\n\n")
} else {
  cat("根据Levene's检验结果 (p <= 0.05)，两组方差不齐，使用Welch's t检验。\n\n")
}

cat("独立样本t检验结果:\n")
t.test(cholesterol_diabetic, cholesterol_normal, var.equal = variances_equal)

```
